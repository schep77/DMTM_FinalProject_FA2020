---
title: "Data Mining and Text Mining - Final Project"
author: "Kyle Dean, Kaitlyn Scheppa, Orel Yoshia"
output: html_notebook
---

```{r}
library(tidyverse)
library(dplyr)
library(dbscan)
```


Our Dataset: 

```{r}
USBirths <- read.csv("https://raw.githubusercontent.com/reisanar/datasets/master/us_births_00_14.csv")
```


##Introduction

  The goal of our project is to explore the birthrates within the US and identify anomalous characteristics of birthrates, and to find the most popular times at which a child is born. In this project, we use the us_birth_00_14 dataset, which is a collections of the number of births from 2000 January 1st to 2014 December 31st. This collection has every single day between those dates, which will be used to analyze which days of birth are the most common every year, and any drastic changes in birthrates.


##Data Exploration

```{r}
head(USBirths)
```
```{r}
boxplot(USBirths$births  ~ USBirths$year, 
        main="Births by Year", ylab = "Number", xlab = "Year")
```


```{r}
birthRates <- USBirths %>% 
  group_by(year) %>% 
  mutate(cbr = births/sum(births) * 1000) %>%  #cbr is the crude birth rate, and to find it you divide the sume of the births per year, by the births of that day, then multiply by 1000
  ungroup()
```

```{r}
boxplot.stats(birthRates$cbr)$out
```
```{r}
boxplot(birthRates$cbr)
```




```{r}
USBirths$mmdd = paste(USBirths$month, USBirths$date_of_month)
USBirths
```
```{r, message=FALSE}
averageBPD <- USBirths %>% 
  group_by(mmdd = substr(mmdd, 1, 31)) %>% 
  summarise(births = sum(births)/15) %>%
  arrange(desc(births)) %>% 
  ungroup() 

averageBPD
  
```
```{r}
ggplot() +
geom_point(averageBPD, mapping = aes(x = mmdd, y = births))
```

```{r}
boxplot.stats(averageBPD$births)$out
```
```{r}
boxplot(averageBPD$births)
```



## Data Analysis



```{r}
novemberBirths <- USBirths %>% #11 is also kinda good 
  group_by(month) %>% 
  filter(month==11) %>% 
  ungroup() %>% 
  select(births, year)

novemberBirths
```


```{r}
ggplot(novemberBirths, aes(x = year, y = births)) +
  geom_histogram(stat = "identity")
```




```{r}
jun06 <- USBirths %>% 
  filter(year == 2006) %>% 
  filter(month == 06)

jun06

ggplot(jun06, aes(x = births, y = date)) +
geom_point() +
labs(x = "Number of Births",
y = "Date",
title = "US Births on 06-06-06")
```


```{r}
jul07 <- USBirths %>% 
  filter(year == 2007) %>% 
  filter(month == 07)

jul07

ggplot(jul07, aes(x = births, y = date)) +
geom_point() +
labs(x = "Number of Births",
y = "Date",
title = "US Births on 07-07-07")
```

```{r}
aug08 <- USBirths %>% 
  filter(year == 2008) %>% 
  filter(month == 08)

aug08

ggplot(aug08, aes(x = births, y = date)) +
geom_point() +
labs(x = "Number of Births",
y = "Date",
title = "US Births on 08-08-08")
```

```{r}
nov11 <- USBirths %>% 
  filter(year == 2011) %>% 
  filter(month == 11)

nov11
```
 
```{r}
ggplot(nov11, aes(x = births, y = date)) +
geom_point() +
labs(x = "Number of Births",
y = "Date",
title = "US Births on 11-11-11")
```


## Anomaly Dectection with Birthrates
## Days of the week


Sum of Births based on Day of the Week
```{r}
USBirths %>% 
  group_by(day_of_week) %>% 
  summarise(Sum_of_Births = sum(births))
```

```{r}
USBirths$day_of_week <- factor(USBirths$day_of_week, levels = c("Sun", "Mon", "Tues", "Wed", "Thurs", "Fri", "Sat"))

ggplot(USBirths, aes(fill = day_of_week, y = births, x = day_of_week)) +
  geom_bar(position = "dodge", stat = "identity") +
  ggtitle("Day of the Week VS. Births")
```


